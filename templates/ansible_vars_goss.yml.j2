## metadata for Audit benchmark
benchmark_version: '3.5'

# Set if genuine RHEL (subscription manager check) not for derivatives e.g. CentOS
is_redhat_os: {% if ansible_distribution == "RedHat" %}true{% else %}false{% endif %}

### Variables for for stig options
run_heavy_tests: {{ audit_run_heavy_tests }}
timeout_ms: {{ audit_cmd_timeout }}

# If running on RHEL7 <= 7.2
rhel7stig_legacyOS: {% if ansible_distribution_version > '7.2' %} false {% else %} true {% endif %}


# If running non UEFI bootloader
rhel7stig_legacy_boot: {{ rhel7stig_legacy_boot }}


## Stig Categories
rhel7stig_cat1: {{ rhel7stig_cat1_patch }}
rhel7stig_cat2: {{ rhel7stig_cat2_patch }}
rhel7stig_cat3: {{ rhel7stig_cat3_patch }}

## CAT I 
RHEL_07_010010: {{ rhel_07_010010 }}
RHEL_07_010020: {{ rhel_07_010020 }}
RHEL_07_010290: {{ rhel_07_010290 }}
RHEL_07_010291: {{ rhel_07_010291 }}
RHEL_07_010300: {{ rhel_07_010300 }}
RHEL_07_010440: {{ rhel_07_010440 }}
RHEL_07_010450: {{ rhel_07_010450 }}
RHEL_07_010482: {{ rhel_07_010482 }}
RHEL_07_010491: {{ rhel_07_010491 }}
RHEL_07_020000: {{ rhel_07_020000 }}
RHEL_07_020010: {{ rhel_07_020010 }}
RHEL_07_020050: {{ rhel_07_020050 }}
RHEL_07_020060: {{ rhel_07_020060 }}
RHEL_07_020230: {{ rhel_07_020230 }}
RHEL_07_020231: {{ rhel_07_020231 }}
RHEL_07_020250: {{ rhel_07_020250 }}
RHEL_07_021350: {{ rhel_07_021350 }}
RHEL_07_021710: {{ rhel_07_021710 }}
RHEL_07_020310: {{ rhel_07_020310 }}
RHEL_07_032000: {{ rhel_07_032000 }}
RHEL_07_040390: {{ rhel_07_040390 }}
RHEL_07_040540: {{ rhel_07_040540 }}
RHEL_07_040550: {{ rhel_07_040550 }}
RHEL_07_040690: {{ rhel_07_040690 }}
RHEL_07_040700: {{ rhel_07_040700 }}
RHEL_07_040800: {{ rhel_07_040800 }}


## Cat II
RHEL_07_010030: {{ rhel_07_010030 }}
RHEL_07_010040: {{ rhel_07_010040 }}
RHEL_07_010050: {{ rhel_07_010050 }}
RHEL_07_010060: {{ rhel_07_010060 }}
RHEL_07_010061: {{ rhel_07_010061 }}
RHEL_07_010062: {{ rhel_07_010062 }}
RHEL_07_010070: {{ rhel_07_010070 }}
RHEL_07_010081: {{ rhel_07_010081 }}
RHEL_07_010082: {{ rhel_07_010082 }}
RHEL_07_010090: {{ rhel_07_010090 }}
RHEL_07_010100: {{ rhel_07_010100 }}
RHEL_07_010101: {{ rhel_07_010101 }}
RHEL_07_010110: {{ rhel_07_010110 }}
RHEL_07_010118: {{ rhel_07_010118 }}
RHEL_07_010119: {{ rhel_07_010119 }}
RHEL_07_010120: {{ rhel_07_010120 }}
RHEL_07_010130: {{ rhel_07_010130 }}
RHEL_07_010140: {{ rhel_07_010140 }}
RHEL_07_010150: {{ rhel_07_010150 }}
RHEL_07_010160: {{ rhel_07_010160 }}
RHEL_07_010170: {{ rhel_07_010170 }}
RHEL_07_010180: {{ rhel_07_010180 }}
RHEL_07_010190: {{ rhel_07_010190 }}
RHEL_07_010199: {{ rhel_07_010199 }}
RHEL_07_010200: {{ rhel_07_010200 }}
RHEL_07_010210: {{ rhel_07_010210 }}
RHEL_07_010220: {{ rhel_07_010220 }}
RHEL_07_010230: {{ rhel_07_010230 }}
RHEL_07_010240: {{ rhel_07_010240 }}
RHEL_07_010250: {{ rhel_07_010250 }}
RHEL_07_010260: {{ rhel_07_010260 }}
RHEL_07_010270: {{ rhel_07_010270 }}
RHEL_07_010271: {{ rhel_07_010271 }}
RHEL_07_010280: {{ rhel_07_010280 }}
RHEL_07_010310: {{ rhel_07_010310 }}
RHEL_07_010320: {{ rhel_07_010320 }}
RHEL_07_010330: {{ rhel_07_010330 }}
RHEL_07_010339: {{ rhel_07_010339 }}
RHEL_07_010340: {{ rhel_07_010340 }}
RHEL_07_010341: {{ rhel_07_010341 }}
RHEL_07_010342: {{ rhel_07_010342 }}
RHEL_07_010343: {{ rhel_07_010343 }}
RHEL_07_010344: {{ rhel_07_010344 }}
RHEL_07_010350: {{ rhel_07_010350 }}
RHEL_07_010430: {{ rhel_07_010430 }}
RHEL_07_010460: {{ rhel_07_010460 }}
RHEL_07_010470: {{ rhel_07_010470 }}
RHEL_07_010481: {{ rhel_07_010481 }}
RHEL_07_010483: {{ rhel_07_010483 }}
RHEL_07_010492: {{ rhel_07_010492 }}
RHEL_07_010500: {{ rhel_07_010500 }}
RHEL_07_020019: {{ rhel_07_020019 }}
RHEL_07_020020: {{ rhel_07_020020 }}
RHEL_07_020021: {{ rhel_07_020021 }}
RHEL_07_020022: {{ rhel_07_020022 }}
RHEL_07_020023: {{ rhel_07_020023 }}
RHEL_07_020029: {{ rhel_07_020029 }}
RHEL_07_020030: {{ rhel_07_020030 }}
RHEL_07_020040: {{ rhel_07_020040 }} # see rhel7stig_notify_command
RHEL_07_020100: {{ rhel_07_020100 }}
RHEL_07_020101: {{ rhel_07_020101 }}
RHEL_07_020110: {{ rhel_07_020110 }}
RHEL_07_020111: {{ rhel_07_020111 }}
RHEL_07_020210: {{ rhel_07_020210 }}
RHEL_07_020220: {{ rhel_07_020220 }}
RHEL_07_020240: {{ rhel_07_020240 }}
RHEL_07_020260: {{ rhel_07_020260 }}
RHEL_07_020270: {{ rhel_07_020270 }}
RHEL_07_020320: {{ rhel_07_020320 }}
RHEL_07_020330: {{ rhel_07_020330 }}
RHEL_07_020610: {{ rhel_07_020610 }}
RHEL_07_020620: {{ rhel_07_020620 }}
RHEL_07_020630: {{ rhel_07_020630 }}
RHEL_07_020640: {{ rhel_07_020640 }}
RHEL_07_020650: {{ rhel_07_020650 }}
RHEL_07_020660: {{ rhel_07_020660 }}  ## WIP
RHEL_07_020670: {{ rhel_07_020670 }}  ## WIP
RHEL_07_020680: {{ rhel_07_020680 }}  ## WIP
RHEL_07_020690: {{ rhel_07_020690 }}  ## WIP
RHEL_07_020700: {{ rhel_07_020700 }}  ## WIP
RHEL_07_020710: {{ rhel_07_020710 }}  ## WIP
RHEL_07_020720: {{ rhel_07_020720 }}  ## WIP
RHEL_07_020730: {{ rhel_07_020730 }}
RHEL_07_020900: {{ rhel_07_020900 }}
RHEL_07_021000: {{ rhel_07_021000 }}
RHEL_07_021010: {{ rhel_07_021010 }}
RHEL_07_021020: {{ rhel_07_021020 }}
RHEL_07_021021: {{ rhel_07_021021 }}
RHEL_07_021030: {{ rhel_07_021030 }}
RHEL_07_021031: {{ rhel_07_021031 }}
RHEL_07_021040: {{ rhel_07_021040 }}
RHEL_07_021100: {{ rhel_07_021100 }}
RHEL_07_021110: {{ rhel_07_021110 }}
RHEL_07_021120: {{ rhel_07_021120 }}
RHEL_07_021300: {{ rhel_07_021300 }}
RHEL_07_021620: {{ rhel_07_021620 }}
RHEL_07_021700: {{ rhel_07_021700 }}
RHEL_07_030000: {{ rhel_07_030000 }}
RHEL_07_030010: {{ rhel_07_030010 }}
RHEL_07_030201: {{ rhel_07_030201 }}
RHEL_07_030210: {{ rhel_07_030210 }}
RHEL_07_030211: {{ rhel_07_030211 }}
# if you set 030300 to 'true' ensure you define rhel7stig_audisp_remote_server
RHEL_07_010375: {{ rhel_07_010375 }}
RHEL_07_030300: {{ rhel_07_030300 }}
RHEL_07_030310: {{ rhel_07_030310 }}
RHEL_07_030320: {{ rhel_07_030320 }}
RHEL_07_030321: {{ rhel_07_030321 }}
RHEL_07_030330: {{ rhel_07_030330 }}
RHEL_07_030340: {{ rhel_07_030340 }}
RHEL_07_030350: {{ rhel_07_030350 }}
RHEL_07_030360: {{ rhel_07_030360 }}
RHEL_07_030370: {{ rhel_07_030370 }}
RHEL_07_030410: {{ rhel_07_030410 }}
RHEL_07_030440: {{ rhel_07_030440 }}
RHEL_07_030510: {{ rhel_07_030510 }}
RHEL_07_030560: {{ rhel_07_030560 }}
RHEL_07_030570: {{ rhel_07_030570 }}
RHEL_07_030580: {{ rhel_07_030580 }}
RHEL_07_030590: {{ rhel_07_030590 }}
RHEL_07_030610: {{ rhel_07_030610 }}
RHEL_07_030620: {{ rhel_07_030620 }}
RHEL_07_030630: {{ rhel_07_030630 }}
RHEL_07_030640: {{ rhel_07_030640 }}
RHEL_07_030650: {{ rhel_07_030650 }}
RHEL_07_030660: {{ rhel_07_030660 }}
RHEL_07_030670: {{ rhel_07_030670 }}
RHEL_07_030680: {{ rhel_07_030680 }}
RHEL_07_030690: {{ rhel_07_030690 }}
RHEL_07_030700: {{ rhel_07_030700 }}
RHEL_07_030710: {{ rhel_07_030710 }}
RHEL_07_030720: {{ rhel_07_030720 }}
RHEL_07_030740: {{ rhel_07_030740 }}
RHEL_07_030750: {{ rhel_07_030750 }}
RHEL_07_030760: {{ rhel_07_030760 }}
RHEL_07_030770: {{ rhel_07_030770 }}
RHEL_07_030780: {{ rhel_07_030780 }}
RHEL_07_030800: {{ rhel_07_030800 }}
RHEL_07_030810: {{ rhel_07_030810 }}
RHEL_07_030819: {{ rhel_07_030819 }}
RHEL_07_030820: {{ rhel_07_030820 }}
RHEL_07_030821: {{ rhel_07_030821 }}
RHEL_07_030830: {{ rhel_07_030830 }}
RHEL_07_030840: {{ rhel_07_030840 }}
RHEL_07_030870: {{ rhel_07_030870 }}
RHEL_07_030871: {{ rhel_07_030871 }}
RHEL_07_030872: {{ rhel_07_030872 }}
RHEL_07_030873: {{ rhel_07_030873 }}
RHEL_07_030874: {{ rhel_07_030874 }}
RHEL_07_030880: {{ rhel_07_030880 }}
RHEL_07_030890: {{ rhel_07_030890 }}
RHEL_07_030900: {{ rhel_07_030900 }}
RHEL_07_030910: {{ rhel_07_030910 }}
RHEL_07_030920: {{ rhel_07_030920 }}
RHEL_07_031000: {{ rhel_07_031000 }}
RHEL_07_031010: {{ rhel_07_031010 }}
RHEL_07_040100: {{ rhel_07_040100 }}
RHEL_07_040110: {{ rhel_07_040110 }}
RHEL_07_040160: {{ rhel_07_040160 }}
RHEL_07_040170: {{ rhel_07_040170 }}
RHEL_07_040180: {{ rhel_07_040180 }}
RHEL_07_040190: {{ rhel_07_040190 }}
RHEL_07_040200: {{ rhel_07_040200 }}
RHEL_07_040201: {{ rhel_07_040201 }}
RHEL_07_040300: {{ rhel_07_040300 }}
RHEL_07_040310: {{ rhel_07_040310 }}
RHEL_07_040320: {{ rhel_07_040320 }}
RHEL_07_040330: {{ rhel_07_040330 }}
RHEL_07_040340: {{ rhel_07_040340 }}
RHEL_07_040350: {{ rhel_07_040350 }}
RHEL_07_040360: {{ rhel_07_040360 }}
RHEL_07_040370: {{ rhel_07_040370 }}
RHEL_07_040380: {{ rhel_07_040380 }}
RHEL_07_040400: {{ rhel_07_040400 }}
RHEL_07_040410: {{ rhel_07_040410 }}
RHEL_07_040420: {{ rhel_07_040420 }}
RHEL_07_040430: {{ rhel_07_040430 }}
RHEL_07_040440: {{ rhel_07_040440 }}
RHEL_07_040450: {{ rhel_07_040450 }}
RHEL_07_040460: {{ rhel_07_040460 }}
RHEL_07_040470: {{ rhel_07_040470 }}
RHEL_07_040500: {{ rhel_07_040500 }}
RHEL_07_040520: {{ rhel_07_040520 }}
RHEL_07_040610: {{ rhel_07_040610 }}
RHEL_07_040611: {{ rhel_07_040611 }}
RHEL_07_040612: {{ rhel_07_040612 }}
RHEL_07_040620: {{ rhel_07_040620 }}
RHEL_07_040630: {{ rhel_07_040630 }}
RHEL_07_040640: {{ rhel_07_040640 }}
RHEL_07_040641: {{ rhel_07_040641 }}
RHEL_07_040650: {{ rhel_07_040650 }}
RHEL_07_040660: {{ rhel_07_040660 }}
RHEL_07_040670: {{ rhel_07_040670 }}
RHEL_07_040680: {{ rhel_07_040680 }}
RHEL_07_040710: {{ rhel_07_040710 }}
RHEL_07_040711: {{ rhel_07_040711 }}
RHEL_07_040712: {{ rhel_07_040712 }}
RHEL_07_040720: {{ rhel_07_040720 }}
RHEL_07_040730: {{ rhel_07_040730 }}
RHEL_07_040740: {{ rhel_07_040740 }}
RHEL_07_040750: {{ rhel_07_040750 }}
RHEL_07_040810: {{ rhel_07_040810 }}
RHEL_07_040820: {{ rhel_07_040820 }}
RHEL_07_040830: {{ rhel_07_040830 }}
RHEL_07_041001: {{ rhel_07_041001 }}
RHEL_07_041002: {{ rhel_07_041002 }}
RHEL_07_041003: {{ rhel_07_041003 }}
RHEL_07_041010: {{ rhel_07_041010 }}
RHEL_07_910055: {{ rhel_07_910055 }}


## Cat III
RHEL_07_010375: {{ rhel_07_010375 }}
RHEL_07_020200: {{ rhel_07_020200 }}
RHEL_07_020300: {{ rhel_07_020300 }}
RHEL_07_021024: {{ rhel_07_021024 }}
RHEL_07_021310: {{ rhel_07_021310 }}
RHEL_07_021320: {{ rhel_07_021320 }}
RHEL_07_021330: {{ rhel_07_021330 }}
RHEL_07_021340: {{ rhel_07_021340 }}
RHEL_07_021600: {{ rhel_07_021600 }}
RHEL_07_021610: {{ rhel_07_021610 }}
RHEL_07_040000: {{ rhel_07_040000 }}
RHEL_07_040530: {{ rhel_07_040530 }}
RHEL_07_040600: {{ rhel_07_040600 }}



# if using gnome/gui or not
rhel7stig_gui: {{ rhel7stig_gui }}

# Whether or not to run tasks related to smart card authentication enforcement
rhel7stig_smartcard: {{ rhel7stig_smartcard }}
# Configure your smartcard driver
rhel7stig_smartcarddriver: {{ rhel7stig_smartcarddriver }}

# AntiVirus
# Set true to skip AV check
rhel7stig_antivirus_required: {{ rhel7stig_antivirus_required }}
# Give process name as process should run
Antivirus_ProcessName: {{ rhel7stig_av_package.package[0] }}

rhel7stig_bootloader_password_hash: {{ rhel7stig_bootloader_password_hash }}

# set to ntpd or chrony accordingly
rhel7stig_time_service: {{ rhel7stig_time_service }}

rhel7stig_auditd: true
rhel7stig_tftp_required: {{ rhel7stig_tftp_required }}

rhel7stig_nameservers: {{ rhel_07_040600_dns_servers | to_json }}

# RHEL_07_010050
# Ability to use own banner if set to false
rhel7stig_use_disa_banner: true

rhel7stig_disa_logon_banner:
  - 'You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.'
  - 'By using this IS (which includes any device attached to this IS), you consent to the following conditions:'
  - '-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.'
  - '-At any time, the USG may inspect and seize data stored on this IS.'
  - '-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.'
  - '-This IS includes security measures (e.g., authentication and access controls) to protect USG interests\--not for your personal benefit or privacy.'
  - '-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.'

rhel7stig_logon_banner: Restricted System. Only use if you have been authorised to do so.



# Users thats should exist in the sysadm_u selinux User context
rhel7stig_sysadm_u:
# Users thats should exist in the staff_u selinux User context
rhel7stig_staff_u:

# host intrision protection e.g. Mcafee HIPS
rhel7stig_hip_enabled: false
rhel7stig_hip_pkg: 
rhel7stig_hip_proc:

# RHEL-07-010483 & RHEL-07-010492
rhel7stig_grub_superusers: {{ rhel7stig_grub_superusers }}

# RHEL_07_020040 - if notify by mail
rhel7stig_aide_cron:
    user: {{ rhel7stig_aide_cron.user }}
    cron_file: {{ rhel7stig_aide_cron.cron_file }}
    job: {{ rhel7stig_aide_cron.job }}
    hour: {{ rhel7stig_aide_cron.hour }}
    minute: {{ rhel7stig_aide_cron.minute }}
    special_time: {{ rhel7stig_aide_cron.special_time }}
    # Disable the notification check rule to disable mailing notifications
    notify_by_mail: {{ rhel_07_020040 }}
    notify_cmd: ' {{ rhel7stig_aide_cron.notify_cmd }}'
rhel7stig_notify_cmd: ' {{ rhel7stig_aide_cron.notify_cmd }}'

rhel7stig_unnecessary_accounts:
- gopher
- games
- ftp

# RHEL_07_021700 set the value for correctly configured grub bootloader sequence
rhel7stig_grub_bootloader_validorder: " {{ rhel7stig_grub_bootloader_validorder }}"


# RHEL_07_030300 uncomment and set the value to a remote IP address that can receive audit logs
{% if rhel7stig_audisp_remote_server is defined %}
rhel7stig_audisp_remote_server: {{ rhel7stig_audisp_remote_server }}
{% endif %}

# RHEL_07_030320 and RHEL_07_030321
rhel7stig_audisp_disk_full_action: syslog
rhel7stig_audisp_network_failure_action: syslog

# RHEL_07_030330 - 25% space of the /var/log/audit hosted filesystem
rhel7stig_auditd_space_left: 250
# RHEL_07_030350
rhel7stig_auditd_mail_acct: {{ rhel7stig_auditd_mail_acct }}

# UID and GID no system users ID start
rhel7stig_int_uid: {{ rhel7stig_int_gid }}
rhel7stig_int_gid: {{ rhel7stig_int_gid }}

# RHEL_07_031000 - replace with actual server for tests
# note default sets to false (true is set to ensure it exists for goss)
rhel7stig_log_aggregation_server: {{ rhel7stig_log_aggregation_server | default('false', true) }}


# RHEL_07_031010
rhel7stig_system_is_log_aggregator: {{ rhel7stig_system_is_log_aggregator }}


rhel7stig_firewall_service: firewalld
rhel7stig_firewalld_services:
- ssh

# FIPS 140-2

#SSH settings
rhel7stig_ssh_ciphers: {{ rhel7stig_ssh_ciphers }}
rhel7stig_ssh_MACs: {{ rhel7stig_ssh_macs }}
rhel7stig_ssh_kex: {{ rhel7stig_ssh_kex }}
# RHEL_07_040160
# Session timeout setting file (TMOUT setting can be set in multiple files)
# Timeout value is in seconds. (60 seconds * 10 = 600)
rhel7stig_shell_session_timeout:
    timeout: {{ rhel7stig_shell_session_timeout.timeout }}

# RHEL_07_040180
# Whether the system should be using LDAP for authentication
rhel7stig_auth_settings:
{% if rhel7stig_complex %}
    use_ldap: {{ rhel7stig_auth_settings.use_ldap }}
    use_sssd: {{ rhel7stig_auth_settings.use_sssd }}
{% else %}
    use_ldap: false
    use_sssd: false
{% endif %}

# RHEL-07-040740
rhel7stig_system_is_router: {{ rhel7stig_system_is_router }}
